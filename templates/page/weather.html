{% extends "base.html" %}

{% block title %}Погода{% endblock %}

{% block content %}
<style>
  :root {
    --sky-1: #a8c6df;
    --sky-2: #6fa1d3;
    --panel: rgba(255, 255, 255, 0.75);
    --navy: #0c2b52;
    --navy-2: #143b6e;
    --text: #0d1b2a;
  }

  .weather-wrap {
    padding: 24px 0 48px;
    background: linear-gradient(180deg, #eef5fb 0%, #ffffff 40%);
  }

  .weather-hero {
    border-radius: 18px;
    padding: 18px;
    background:
      linear-gradient(135deg, rgba(255,255,255,0.75), rgba(255,255,255,0.3)),
      url("https://images.unsplash.com/photo-1501630834273-4b5604d2ee31?q=80&w=1600&auto=format&fit=crop")
      center/cover no-repeat;
    box-shadow: 0 10px 24px rgba(13, 27, 42, 0.18);
  }

  .weather-hero-inner {
    display: grid;
    grid-template-columns: 1.3fr 1fr 1fr 1fr;
    gap: 14px;
  }

  .city-card {
    background: var(--panel);
    border-radius: 14px;
    padding: 16px;
  }

  .city-temp {
    font-size: 56px;
    font-weight: 700;
    color: var(--text);
    margin-top: 6px;
  }

  .meta-card {
    background: rgba(255,255,255,0.4);
    border-radius: 14px;
    padding: 14px 16px;
    color: var(--text);
    display: grid;
    gap: 6px;
    text-align: center;
  }

  .meta-card .value {
    font-size: 22px;
    font-weight: 700;
  }

  .section-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 20px;
    margin-top: 18px;
  }

  .side-menu {
    background: linear-gradient(180deg, var(--navy), var(--navy-2));
    border-radius: 16px;
    padding: 16px;
    color: #dfe9f6;
  }

  .side-menu h4 {
    font-size: 16px;
    color: #f9d65c;
    margin-bottom: 14px;
  }

  .side-menu ul {
    list-style: none;
    padding-left: 0;
    margin-bottom: 0;
  }

  .side-menu li {
    padding: 10px 0;
    border-bottom: 1px solid rgba(255,255,255,0.12);
  }

  .panel-tabs {
    display: grid;
    grid-template-columns: 1fr;
    gap: 12px;
  }

  .panel-tabs .tab {
    background: linear-gradient(180deg, #0e2f5d, #0b274a);
    color: #fff;
    border-radius: 12px;
    padding: 10px 14px;
    text-align: center;
    font-weight: 600;
  }

  .map-card {
    background: #fff;
    border-radius: 16px;
    padding: 14px;
    box-shadow: 0 8px 18px rgba(13, 27, 42, 0.12);
  }

  .map-image {
    width: 100%;
    border-radius: 12px;
    border: 1px solid #e6eef7;
  }

  .forecast-row {
    display: grid;
    grid-template-columns: repeat(7, minmax(120px, 1fr));
    gap: 12px;
    margin-top: 18px;
  }

  .forecast-card {
    background: #f8fbff;
    border-radius: 12px;
    padding: 10px 12px;
    text-align: center;
    border: 1px solid #e6eef7;
  }

  .forecast-card .date {
    font-size: 13px;
    color: #5d6c7a;
  }

  .forecast-card .temp {
    font-size: 18px;
    font-weight: 700;
  }

  .error-box {
    background: #fff3cd;
    color: #664d03;
    border: 1px solid #ffecb5;
    padding: 10px 12px;
    border-radius: 10px;
    margin-top: 12px;
  }

  @media (max-width: 992px) {
    .weather-hero-inner {
      grid-template-columns: 1fr 1fr;
    }

    .section-grid {
      grid-template-columns: 1fr;
    }

    .forecast-row {
      grid-template-columns: repeat(2, minmax(140px, 1fr));
    }
  }
</style>

<div class="weather-wrap">
  <div class="container">
    <div class="weather-hero">
      <div class="weather-hero-inner">
        <div class="city-card">
          <form method="get">
            <select class="form-select" name="city" onchange="this.form.submit()">
              {% for key, city in cities.items %}
              <option value="{{ key }}" {% if key == city_key %}selected{% endif %}>{{ city.name }}</option>
              {% endfor %}
            </select>
          </form>
          <div class="city-temp">{{ temperature|default:"—" }}°</div>
          <div>{{ weather_text }}</div>
        </div>
        <div class="meta-card">
          <div class="value">{{ humidity|default:"—" }}%</div>
          <div>Влажность</div>
        </div>
        <div class="meta-card">
          <div class="value">{{ wind_speed|default:"—" }} м/с</div>
          <div>Скорость ветра</div>
        </div>
        <div class="meta-card">
          <div class="value">{{ wind_dir }}</div>
          <div>Направление ветра</div>
        </div>
      </div>
    </div>

    {% if error %}
    <div class="error-box">{{ error }}</div>
    {% endif %}

    <div class="section-grid">
      <section class="panel-tabs">
        <div class="tab">Прогноз погоды на 7 дней</div>
        <div class="map-card">
          <img class="map-image" src="{{ map_image_url|default:'/media/kyrgyzstan-map.png' }}" alt="Карта Кыргызстана">
        </div>
        <div class="forecast-row">
          {% for day in forecast %}
          <div class="forecast-card">
            <div class="date">{{ day.date }}</div>
            <div class="temp">{{ day.t_min }}° / {{ day.t_max }}°</div>
            <div>{{ day.text }}</div>
          </div>
          {% endfor %}
        </div>
      </section>
    </div>
  </div>
</div>
{% endblock %}
